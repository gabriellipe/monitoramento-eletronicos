<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Infra√ß√µes Disciplinares</title>
   <link rel="stylesheet" href="design-premium-moderno.css">
    <style>
        /* Estilos espec√≠ficos para compatibilidade com o sistema atual */
        .screen {
            min-height: 100vh;
            padding: var(--space-24);
        }
        
        .screen.hidden {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        .user-type-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-20);
            max-width: 600px;
            margin: 0 auto;
        }
        
        .user-type-btn {
            padding: var(--space-32);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-lg);
            background: var(--color-surface);
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease-standard);
            text-align: center;
            text-decoration: none;
            color: var(--color-text);
        }
        
        .user-type-btn:hover {
            border-color: var(--color-primary);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .user-type-btn h3 {
            margin: 0 0 var(--space-12) 0;
            color: var(--color-primary);
        }
        
        .nav-tab {
            padding: var(--space-12) var(--space-24);
            border: none;
            background: none;
            color: var(--color-text-secondary);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all var(--duration-normal) var(--ease-standard);
        }
        
        .nav-tab:hover {
            color: var(--color-primary);
            background-color: var(--color-secondary);
        }
        
        .nav-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }
        
        .tab-content {
            display: none;
            padding: var(--space-24) 0;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-20);
            margin-bottom: var(--space-32);
        }
        
        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            text-align: center;
            transition: all var(--duration-normal) var(--ease-standard);
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-card h3 {
            font-size: var(--font-size-4xl);
            color: var(--color-primary);
            margin: 0 0 var(--space-8) 0;
        }
        
        .stat-card p {
            margin: 0;
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
        }
        
        .infraction-item {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            margin-bottom: var(--space-16);
            transition: all var(--duration-normal) var(--ease-standard);
        }
        
        .infraction-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }
        
        .status-pendente {
            border-left: 4px solid var(--color-warning);
        }
        
        .status-resolvida {
            border-left: 4px solid var(--color-success);
        }
        
        .infraction-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-12);
        }
        
        .infraction-title {
            margin: 0;
            color: var(--color-primary);
            font-size: var(--font-size-lg);
        }
        
        .infraction-date {
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
        }
        
        .infraction-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-12);
            margin-bottom: var(--space-16);
        }
        
        .infraction-detail {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }
        
        .detail-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            font-weight: var(--font-weight-medium);
        }
        
        .detail-value {
            color: var(--color-text);
            font-weight: var(--font-weight-medium);
        }
        
        .infraction-description {
            background: var(--color-secondary);
            padding: var(--space-12);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-16);
            font-size: var(--font-size-sm);
            line-height: 1.5;
        }
        
        .infraction-actions {
            display: flex;
            gap: var(--space-12);
            justify-content: flex-end;
        }
        
        .penalty-info {
            display: flex;
            align-items: center;
            gap: var(--space-12);
            justify-content: space-between;
        }
        
        .penalty-badge {
            background: var(--color-success);
            color: white;
            padding: var(--space-6) var(--space-12);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
        }
        
        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: var(--space-16);
        }
        
        .filters {
            display: flex;
            gap: var(--space-12);
            margin-bottom: var(--space-24);
            align-items: flex-end;
            flex-wrap: wrap;
        }
        
        .filters > * {
            min-width: 150px;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal.hidden {
            display: none;
        }
        
        .modal-content {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: var(--space-32);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-24);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: var(--space-16);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: var(--font-size-2xl);
            cursor: pointer;
            color: var(--color-text-secondary);
            padding: 0;
        }
        
        .summary-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            color: var(--color-primary);
            margin-bottom: var(--space-12);
        }
        
        .summary-details {
            background: var(--color-secondary);
            padding: var(--space-16);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-24);
            line-height: 1.6;
        }
        
        .message {
            padding: var(--space-12) var(--space-16);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-16);
            font-weight: var(--font-weight-medium);
        }
        
        .message.success {
            background: rgba(var(--color-teal-500-rgb), 0.1);
            border: 1px solid var(--color-success);
            color: var(--color-success);
        }
        
        .message.error {
            background: rgba(var(--color-red-500-rgb), 0.1);
            border: 1px solid var(--color-error);
            color: var(--color-error);
        }
        
        #message-container {
            position: fixed;
            top: var(--space-20);
            right: var(--space-20);
            z-index: 1001;
            max-width: 400px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .user-type-buttons {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filters > * {
                min-width: auto;
            }
            
            .infraction-header {
                flex-direction: column;
                gap: var(--space-8);
            }
            
            .infraction-details {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-12);
            }
        }
    </style>
</head>
<body>
    <!-- Container de Mensagens -->
    <div id="message-container"></div>
    
    <!-- Tela de Sele√ß√£o de Tipo de Usu√°rio -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <h1>Sistema de Infra√ß√µes Disciplinares</h1>
            <div class="login-card">
                <h2>Selecione seu tipo de acesso</h2>
                <div class="user-type-buttons">
                    <a href="#" class="user-type-btn" onclick="showLogin('professor')">
                        <h3>üë®‚Äçüè´ Professor</h3>
                        <p>Registrar infra√ß√µes e acompanhar ocorr√™ncias da sua disciplina</p>
                    </a>
                    <a href="#" class="user-type-btn" onclick="showLogin('gestor')">
                        <h3>üëî Gestor</h3>
                        <p>Gerenciar infra√ß√µes, aplicar penalidades e visualizar relat√≥rios</p>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Tela de Login -->
    <div id="login-form" class="screen hidden">
        <div class="login-container">
            <h1>Login - <span id="login-type">Usu√°rio</span></h1>
            <div class="login-card">
                <form id="loginForm">
                    <div class="input-group">
                        <label for="userSelect">Selecione seu usu√°rio:</label>
                        <select id="userSelect" required>
                            <option value="">Escolha...</option>
                        </select>
                    </div>
                    <button type="submit" class="primary-btn">Entrar no Sistema</button>
                </form>
                <p class="auth-link">
                    <a href="#" onclick="showScreen('login-screen')">‚Üê Voltar √† sele√ß√£o</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Tela do Professor -->
    <div id="professor-screen" class="screen hidden">
        <header class="header">
            <h1>Sistema de Infra√ß√µes - Professor</h1>
            <div class="user-info">
                <span id="professor-name">Professor</span>
                <button onclick="logout()" class="secondary-btn">Sair</button>
            </div>
        </header>

        <main class="main-content">
            <div class="card">
                <h2>üìù Registrar Nova Infra√ß√£o</h2>
                <form id="infracaoForm">
                    <input type="hidden" id="professorField">
                    
                    <div class="row">
                        <div class="input-group">
                            <label for="alunoSelect">Aluno:</label>
                            <select id="alunoSelect" required>
                                <option value="">Selecione o aluno...</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="turmaField">Turma:</label>
                            <input type="text" id="turmaField" readonly>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="dataHoraField">Data e Hora:</label>
                        <input type="text" id="dataHoraField" readonly>
                    </div>
                    
                    <div class="input-group">
                        <label for="descricaoField">Descri√ß√£o da Infra√ß√£o:</label>
                        <select id="descricaoField" required>
                            <option value="">Selecione o tipo de infra√ß√£o</option>
                            <option value="Uso de celular durante a aula">üì± Uso de celular durante a aula</option>
                            <option value="Conversa excessiva durante a explica√ß√£o">üí¨ Conversa excessiva durante a explica√ß√£o</option>
                            <option value="Comportamento inadequado">üò§ Comportamento inadequado</option>
                            <option value="N√£o trouxe material escolar">üìö N√£o trouxe material escolar</option>
                            <option value="Atraso para a aula">‚è∞ Atraso para a aula</option>
                            <option value="Desrespeito com colegas ou professor">üö´ Desrespeito com colegas ou professor</option>
                            <option value="Outras infra√ß√µes disciplinares">‚ùì Outras infra√ß√µes disciplinares</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="observacoesField">Observa√ß√µes Adicionais:</label>
                        <textarea id="observacoesField" rows="3" 
                                  placeholder="Descreva mais detalhes sobre a ocorr√™ncia..."></textarea>
                    </div>
                    
                    <button type="submit" class="primary-btn">üìã Registrar Infra√ß√£o</button>
                </form>
            </div>
        </main>
    </div>

    <!-- Tela do Gestor -->
    <div id="gestor-screen" class="screen hidden">
        <header class="header">
            <h1>Sistema de Infra√ß√µes - Gest√£o</h1>
            <div class="user-info">
                <span id="gestor-name">Gestor</span>
                <button onclick="logout()" class="secondary-btn">Sair</button>
            </div>
        </header>

        <!-- Estat√≠sticas -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3 id="infracoes-hoje">0</h3>
                <p>Infra√ß√µes Hoje</p>
            </div>
            <div class="stat-card">
                <h3 id="infracoes-semana">0</h3>
                <p>Esta Semana</p>
            </div>
            <div class="stat-card">
                <h3 id="infracoes-pendentes">0</h3>
                <p>Pendentes</p>
            </div>
            <div class="stat-card">
                <h3 id="infracoes-resolvidas">0</h3>
                <p>Resolvidas</p>
            </div>
        </div>

        <!-- Navega√ß√£o por Abas -->
        <nav class="tabs">
            <button class="nav-tab active" onclick="showTab('pendentes')">Infra√ß√µes Pendentes</button>
            <button class="nav-tab" onclick="showTab('historico')">Hist√≥rico</button>
        </nav>

        <!-- Conte√∫do das Abas -->
        <main class="main-content">
            <!-- Aba Pendentes -->
            <div id="tab-pendentes" class="tab-content active">
                <div class="card">
                    <h2>‚è≥ Infra√ß√µes Pendentes</h2>
                    
                    <!-- Filtros -->
                    <div class="filters">
                        <div class="input-group">
                            <label for="filtro-professor">Professor:</label>
                            <select id="filtro-professor">
                                <option value="">Todos os professores</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="filtro-turma">Turma:</label>
                            <select id="filtro-turma">
                                <option value="">Todas as turmas</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="filtro-data">Data:</label>
                            <input type="date" id="filtro-data">
                        </div>
                        <button onclick="limparFiltros()" class="secondary-btn">üîÑ Limpar</button>
                    </div>
                    
                    <div id="infracoes-pendentes-list"></div>
                </div>
            </div>

            <!-- Aba Hist√≥rico -->
            <div id="tab-historico" class="tab-content hidden">
                <div class="card">
                    <h2>üìö Hist√≥rico de Infra√ß√µes Resolvidas</h2>
                    <div id="infracoes-historico-list"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Penalidade -->
    <div id="penalidade-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öñÔ∏è Aplicar Penalidade</h2>
                <button type="button" class="modal-close" onclick="fecharModal()">&times;</button>
            </div>
            
            <div id="infraction-summary"></div>
            
            <form id="penalidadeForm">
                <div class="input-group">
                    <label for="penalidade-select">Selecione a penalidade:</label>
                    <select id="penalidade-select" required>
                        <option value="">Escolha a penalidade...</option>
                    </select>
                </div>
                
                <div class="row" style="justify-content: flex-end; margin-top: var(--space-24);">
                    <button type="button" onclick="fecharModal()" class="secondary-btn">Cancelar</button>
                    <button type="submit" class="primary-btn">‚úÖ Aplicar Penalidade</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Script do Sistema -->
    <script>
        // Dados da aplica√ß√£o
        const appData = {
            "professores": [
                {"id": 1, "nome": "Prof. Maria Silva", "disciplina": "Matem√°tica"},
                {"id": 2, "nome": "Prof. Jo√£o Santos", "disciplina": "Hist√≥ria"},
                {"id": 3, "nome": "Prof. Ana Costa", "disciplina": "Portugu√™s"},
                {"id": 4, "nome": "Prof. Carlos Lima", "disciplina": "Ci√™ncias"},
                {"id": 5, "nome": "Prof. Paula Oliveira", "disciplina": "Geografia"}
            ],
            "alunos": [
                {"id": 1, "nome": "Fellipe Souza", "turma": "9¬∞A"},
                {"id": 2, "nome": "Alanna Beatriz", "turma": "8¬∞B"},
                {"id": 3, "nome": "Alan dos santos", "turma": "9¬∞A"},
                {"id": 4, "nome": "Jo√£o Vinicius", "turma": "7¬∞C"},
                {"id": 5, "nome": "Sara Moura", "turma": "8¬∞A"},
                {"id": 6, "nome": "Maria Eduarda", "turma": "9¬∞B"},
                {"id": 7, "nome": "Rafael Oliveira", "turma": "7¬∞A"},
                {"id": 8, "nome": "Isabela Souza", "turma": "8¬∞B"},
                {"id": 9, "nome": "Thiago Pereira", "turma": "9¬∞A"},
                {"id": 10, "nome": "Larissa Martins", "turma": "7¬∞B"},
                {"id": 11, "nome": "Bruno Alves", "turma": "8¬∞C"},
                {"id": 12, "nome": "Camila Rocha", "turma": "9¬∞B"},
                {"id": 13, "nome": "Diego Silva", "turma": "7¬∞A"},
                {"id": 14, "nome": "Fernanda Costa", "turma": "8¬∞A"},
                {"id": 15, "nome": "Mateus Santos", "turma": "9¬∞C"}
            ],
            "turmas": ["7¬∞A", "7¬∞B", "7¬∞C", "8¬∞A", "8¬∞B", "8¬∞C", "9¬∞A", "9¬∞B", "9¬∞C"],
            "tiposPenalidade": [
                "Advert√™ncia Verbal",
                "Advert√™ncia Escrita", 
                "Suspens√£o de Recreio",
                "Comunicado aos Pais",
                "Suspens√£o de 1 dia",
                "Suspens√£o de 3 dias"
            ],
            "infracoes": [
                {
                    "id": 1,
                    "professor": "Prof. Maria Silva",
                    "aluno": "Pedro Henrique",
                    "turma": "9¬∞A",
                    "data": "2025-09-28",
                    "hora": "10:30",
                    "descricao": "Uso de celular durante explica√ß√£o de matem√°tica",
                    "observacoes": "Aluno estava jogando durante a aula",
                    "status": "pendente"
                },
                {
                    "id": 2,
                    "professor": "Prof. Jo√£o Santos", 
                    "aluno": "Amanda Silva",
                    "turma": "8¬∞B",
                    "data": "2025-09-28",
                    "hora": "14:15",
                    "descricao": "Uso de celular durante a aula",
                    "observacoes": "Estava enviando mensagens",
                    "status": "pendente"
                },
                {
                    "id": 3,
                    "professor": "Prof. Ana Costa",
                    "aluno": "Lucas Ferreira", 
                    "turma": "9¬∞A",
                    "data": "2025-09-27",
                    "hora": "08:45",
                    "descricao": "Uso de celular durante a aula",
                    "observacoes": "Terceira ocorr√™ncia do aluno",
                    "status": "resolvida",
                    "penalidade": "Comunicado aos Pais",
                    "dataResolucao": "2025-09-27"
                },
                {
                    "id": 4,
                    "professor": "Prof. Carlos Lima",
                    "aluno": "J√∫lia Santos",
                    "turma": "7¬∞C", 
                    "data": "2025-09-28",
                    "hora": "11:20",
                    "descricao": "Uso de celular durante experimento",
                    "observacoes": "Filmando a aula sem autoriza√ß√£o",
                    "status": "pendente"
                },
                {
                    "id": 5,
                    "professor": "Prof. Paula Oliveira",
                    "aluno": "Gabriel Costa",
                    "turma": "8¬∞A",
                    "data": "2025-09-26",
                    "hora": "16:00",
                    "descricao": "Uso de celular durante a aula",
                    "observacoes": "Atendeu liga√ß√£o durante aula",
                    "status": "resolvida", 
                    "penalidade": "Advert√™ncia Escrita",
                    "dataResolucao": "2025-09-27"
                },
                {
                    "id": 6,
                    "professor": "Prof. Maria Silva",
                    "aluno": "Mariana Lima",
                    "turma": "9¬∞B",
                    "data": "2025-09-25",
                    "hora": "09:15",
                    "descricao": "Uso de celular durante a aula", 
                    "observacoes": "Primeira ocorr√™ncia",
                    "status": "resolvida",
                    "penalidade": "Advert√™ncia Verbal",
                    "dataResolucao": "2025-09-25"
                },
                {
                    "id": 7,
                    "professor": "Prof. Jo√£o Santos",
                    "aluno": "Rafael Oliveira",
                    "turma": "7¬∞A",
                    "data": "2025-09-28",
                    "hora": "13:30",
                    "descricao": "Uso de celular durante a aula",
                    "observacoes": "Ouvindo m√∫sica com fones",
                    "status": "pendente"
                },
                {
                    "id": 8,
                    "professor": "Prof. Ana Costa", 
                    "aluno": "Isabela Souza",
                    "turma": "8¬∞B",
                    "data": "2025-09-26",
                    "hora": "07:50",
                    "descricao": "Uso de celular durante a aula",
                    "observacoes": "Segunda ocorr√™ncia da semana",
                    "status": "resolvida",
                    "penalidade": "Suspens√£o de Recreio", 
                    "dataResolucao": "2025-09-26"
                }
            ]
        };

        // Estado da aplica√ß√£o
        let currentUser = null;
        let currentUserType = null;
        let currentInfractionId = null;

        // Inicializa√ß√£o da aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Configurar eventos de formul√°rios
            setupFormEvents();
            
            // Atualizar data e hora atual
            updateCurrentDateTime();
        }

        function setupFormEvents() {
            // Login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }
            
            // Infra√ß√£o form
            const infracaoForm = document.getElementById('infracaoForm');
            if (infracaoForm) {
                infracaoForm.addEventListener('submit', handleInfracaoSubmit);
            }
            
            // Penalidade form
            const penalidadeForm = document.getElementById('penalidadeForm');
            if (penalidadeForm) {
                penalidadeForm.addEventListener('submit', handlePenalidadeSubmit);
            }
            
            // Aluno select change
            const alunoSelect = document.getElementById('alunoSelect');
            if (alunoSelect) {
                alunoSelect.addEventListener('change', updateTurmaField);
            }
            
            // Filtros
            setupFilters();
        }

        function setupFilters() {
            const filtros = ['filtro-professor', 'filtro-turma', 'filtro-data'];
            filtros.forEach(filtroId => {
                const filtro = document.getElementById(filtroId);
                if (filtro) {
                    filtro.addEventListener('change', applyFilters);
                }
            });
        }

        // Navega√ß√£o entre telas
        function showScreen(screenId) {
            // Esconder todas as telas
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
                screen.classList.add('hidden');
            });
            
            // Mostrar tela solicitada
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.remove('hidden');
                targetScreen.classList.add('active');
            }
        }

        function showLogin(userType) {
            currentUserType = userType;
            
            // Atualizar t√≠tulo
            const loginTypeSpan = document.getElementById('login-type');
            if (loginTypeSpan) {
                loginTypeSpan.textContent = userType === 'professor' ? 'Professor' : 'Gestor';
            }
            
            // Carregar op√ß√µes do select
            const userSelect = document.getElementById('userSelect');
            if (userSelect) {
                userSelect.innerHTML = '<option value="">Escolha...</option>';
                
                if (userType === 'professor') {
                    appData.professores.forEach(prof => {
                        const option = document.createElement('option');
                        option.value = prof.id;
                        option.textContent = prof.nome;
                        userSelect.appendChild(option);
                    });
                } else {
                    // Para gestor, adicionar op√ß√£o gen√©rica
                    const option = document.createElement('option');
                    option.value = 'gestor';
                    option.textContent = 'Coordena√ß√£o Pedag√≥gica';
                    userSelect.appendChild(option);
                }
            }
            
            showScreen('login-form');
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const userSelect = document.getElementById('userSelect');
            const selectedValue = userSelect.value;
            
            if (!selectedValue) {
                showMessage('Por favor, selecione um usu√°rio', 'error');
                return;
            }
            
            if (currentUserType === 'professor') {
                const professor = appData.professores.find(p => p.id == selectedValue);
                currentUser = professor;
                
                // Atualizar interface do professor
                const professorNameElement = document.getElementById('professor-name');
                const professorFieldElement = document.getElementById('professorField');
                
                if (professorNameElement) professorNameElement.textContent = professor.nome;
                if (professorFieldElement) professorFieldElement.value = professor.nome;
                
                // Carregar op√ß√µes para o professor
                loadProfessorSelectOptions();
                
                showScreen('professor-screen');
            } else {
                currentUser = { nome: 'Coordena√ß√£o Pedag√≥gica', tipo: 'gestor' };
                
                // Atualizar interface do gestor
                const gestorNameElement = document.getElementById('gestor-name');
                if (gestorNameElement) gestorNameElement.textContent = 'Coordena√ß√£o Pedag√≥gica';
                
                // Carregar dados do gestor
                loadGestorData();
                
                showScreen('gestor-screen');
            }
            
            showMessage('Login realizado com sucesso!', 'success');
        }

        function logout() {
            currentUser = null;
            currentUserType = null;
            showScreen('login-screen');
            showMessage('Logout realizado com sucesso!', 'success');
        }

        // Fun√ß√µes do Professor
        function loadProfessorSelectOptions() {
            // Carregar alunos
            const alunoSelect = document.getElementById('alunoSelect');
            if (alunoSelect) {
                alunoSelect.innerHTML = '<option value="">Selecione o aluno...</option>';
                appData.alunos.forEach(aluno => {
                    const option = document.createElement('option');
                    option.value = aluno.id;
                    option.textContent = aluno.nome;
                    option.dataset.turma = aluno.turma;
                    alunoSelect.appendChild(option);
                });
            }
        }

        function loadGestorSelectOptions() {
            // Carregar penalidades
            const penalidadeSelect = document.getElementById('penalidade-select');
            if (penalidadeSelect) {
                penalidadeSelect.innerHTML = '<option value="">Escolha a penalidade...</option>';
                appData.tiposPenalidade.forEach(penalidade => {
                    const option = document.createElement('option');
                    option.value = penalidade;
                    option.textContent = penalidade;
                    penalidadeSelect.appendChild(option);
                });
            }
        }

        function updateTurmaField() {
            const alunoSelect = document.getElementById('alunoSelect');
            const turmaField = document.getElementById('turmaField');
            
            if (alunoSelect && turmaField && alunoSelect.value) {
                const selectedOption = alunoSelect.options[alunoSelect.selectedIndex];
                turmaField.value = selectedOption.dataset.turma || '';
            } else if (turmaField) {
                turmaField.value = '';
            }
        }

        function updateCurrentDateTime() {
            const now = new Date();
            const dataHoraField = document.getElementById('dataHoraField');
            
            if (dataHoraField) {
                const formatted = now.toLocaleString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                dataHoraField.value = formatted;
            }
        }

        function handleInfracaoSubmit(e) {
            e.preventDefault();
            
            const alunoSelect = document.getElementById('alunoSelect');
            const turmaField = document.getElementById('turmaField');
            const descricaoField = document.getElementById('descricaoField');
            const observacoesField = document.getElementById('observacoesField');
            
            if (!alunoSelect || !alunoSelect.value) {
                showMessage('Por favor, selecione um aluno', 'error');
                return;
            }
            
            const aluno = appData.alunos.find(a => a.id == alunoSelect.value);
            const now = new Date();
            
            const novaInfracao = {
                id: Math.max(...appData.infracoes.map(i => i.id)) + 1,
                professor: currentUser.nome,
                aluno: aluno.nome,
                turma: aluno.turma,
                data: now.toISOString().split('T')[0],
                hora: now.toTimeString().substring(0, 5),
                descricao: descricaoField ? descricaoField.value : 'Uso de celular durante a aula',
                observacoes: observacoesField ? observacoesField.value : '',
                status: 'pendente'
            };
            
            appData.infracoes.push(novaInfracao);
            
            // Limpar formul√°rio
            const infracaoForm = document.getElementById('infracaoForm');
            if (infracaoForm) {
                infracaoForm.reset();
                updateCurrentDateTime();
                const professorField = document.getElementById('professorField');
                if (professorField) professorField.value = currentUser.nome;
            }
            
            showMessage('Infra√ß√£o registrada com sucesso!', 'success');
        }

        // Fun√ß√µes do Gestor
        function loadGestorData() {
            calculateStatistics();
            loadFiltersOptions();
            loadGestorSelectOptions();
            loadInfractionsList();
        }

        function calculateStatistics() {
            const hoje = new Date().toISOString().split('T')[0];
            const inicioSemana = getStartOfWeek(new Date()).toISOString().split('T')[0];
            
            const infracoesHoje = appData.infracoes.filter(i => i.data === hoje).length;
            const infrucoesSemana = appData.infracoes.filter(i => i.data >= inicioSemana).length;
            const infracoesPendentes = appData.infracoes.filter(i => i.status === 'pendente').length;  
            const infracoesResolvidas = appData.infracoes.filter(i => i.status === 'resolvida').length;
            
            const elements = {
                'infracoes-hoje': infracoesHoje,
                'infracoes-semana': infrucoesSemana,
                'infracoes-pendentes': infracoesPendentes,
                'infracoes-resolvidas': infracoesResolvidas
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        function getStartOfWeek(date) {
            const startOfWeek = new Date(date);
            const day = startOfWeek.getDay();
            const diff = startOfWeek.getDate() - day;
            return new Date(startOfWeek.setDate(diff));
        }

        function loadFiltersOptions() {
            // Filtro de professores
            const filtroProfessor = document.getElementById('filtro-professor');
            if (filtroProfessor) {
                filtroProfessor.innerHTML = '<option value="">Todos os professores</option>';
                const professoresUnicos = [...new Set(appData.infracoes.map(i => i.professor))];
                professoresUnicos.forEach(prof => {
                    const option = document.createElement('option');
                    option.value = prof;
                    option.textContent = prof;
                    filtroProfessor.appendChild(option);
                });
            }
            
            // Filtro de turmas
            const filtroTurma = document.getElementById('filtro-turma');
            if (filtroTurma) {
                filtroTurma.innerHTML = '<option value="">Todas as turmas</option>';
                appData.turmas.forEach(turma => {
                    const option = document.createElement('option');
                    option.value = turma;
                    option.textContent = turma;
                    filtroTurma.appendChild(option);
                });
            }
        }

        function loadInfractionsList() {
            loadPendingInfractions();
            loadHistoryInfractions();
        }

        function loadPendingInfractions() {
            const container = document.getElementById('infracoes-pendentes-list');
            if (!container) return;
            
            const infractions = appData.infracoes.filter(i => i.status === 'pendente');
            
            if (infractions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìù</div>
                        <p>Nenhuma infra√ß√£o pendente no momento</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = infractions.map(infraction => createInfractionHTML(infraction, true)).join('');
        }

        function loadHistoryInfractions() {
            const container = document.getElementById('infracoes-historico-list');
            if (!container) return;
            
            const infractions = appData.infracoes.filter(i => i.status === 'resolvida');
            
            if (infractions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìö</div>
                        <p>Nenhuma infra√ß√£o resolvida ainda</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = infractions.map(infraction => createInfractionHTML(infraction, false)).join('');
        }

        function createInfractionHTML(infraction, showActions = true) {
            const dataFormatada = new Date(infraction.data + 'T00:00:00').toLocaleDateString('pt-BR');
            const statusClass = infraction.status === 'pendente' ? 'status-pendente' : 'status-resolvida penalty-applied';
            
            return `
                <div class="infraction-item ${statusClass}">
                    <div class="infraction-header">
                        <h4 class="infraction-title">${infraction.aluno}</h4>
                        <span class="infraction-date">${dataFormatada} √†s ${infraction.hora}</span>
                    </div>
                    
                    <div class="infraction-details">
                        <div class="infraction-detail">
                            <span class="detail-label">Professor:</span>
                            <span class="detail-value">${infraction.professor}</span>
                        </div>
                        <div class="infraction-detail">
                            <span class="detail-label">Turma:</span>
                            <span class="detail-value">${infraction.turma}</span>
                        </div>
                    </div>
                    
                    <div class="infraction-description">
                        <strong>Descri√ß√£o:</strong> ${infraction.descricao}
                        ${infraction.observacoes ? `<br><strong>Observa√ß√µes:</strong> ${infraction.observacoes}` : ''}
                    </div>
                    
                    ${showActions ? `
                        <div class="infraction-actions">
                            <button class="btn primary-btn" onclick="abrirModalPenalidade(${infraction.id})">
                                ‚öñÔ∏è Aplicar Penalidade
                            </button>
                        </div>
                    ` : `
                        <div class="penalty-info">
                            <span class="penalty-badge">${infraction.penalidade}</span>
                            <span>Aplicada em ${new Date(infraction.dataResolucao + 'T00:00:00').toLocaleDateString('pt-BR')}</span>
                        </div>
                    `}
                </div>
            `;
        }

        // Navega√ß√£o por abas
        function showTab(tabName) {
            // Atualizar navega√ß√£o
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Mostrar conte√∫do
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                content.classList.add('hidden');
            });
            
            const targetTab = document.getElementById(`tab-${tabName}`);
            if (targetTab) {
                targetTab.classList.remove('hidden');
                targetTab.classList.add('active');
            }
        }

        // Sistema de filtros
        function applyFilters() {
            const filtroProfessor = document.getElementById('filtro-professor');
            const filtroTurma = document.getElementById('filtro-turma');
            const filtroData = document.getElementById('filtro-data');
            
            const filtroProfessorValue = filtroProfessor ? filtroProfessor.value : '';
            const filtroTurmaValue = filtroTurma ? filtroTurma.value : '';
            const filtroDataValue = filtroData ? filtroData.value : '';
            
            let infracoesFiltradas = appData.infracoes.filter(i => i.status === 'pendente');
            
            if (filtroProfessorValue) {
                infracoesFiltradas = infracoesFiltradas.filter(i => i.professor === filtroProfessorValue);
            }
            
            if (filtroTurmaValue) {
                infracoesFiltradas = infracoesFiltradas.filter(i => i.turma === filtroTurmaValue);
            }
            
            if (filtroDataValue) {
                infracoesFiltradas = infracoesFiltradas.filter(i => i.data === filtroDataValue);
            }
            
            const container = document.getElementById('infracoes-pendentes-list');
            if (!container) return;
            
            if (infracoesFiltradas.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <p>Nenhuma infra√ß√£o encontrada com os filtros aplicados</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = infracoesFiltradas.map(infraction => createInfractionHTML(infraction, true)).join('');
        }

        function limparFiltros() {
            const elements = ['filtro-professor', 'filtro-turma', 'filtro-data'];
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            loadPendingInfractions();
        }

        // Sistema de modal para penalidades
        function abrirModalPenalidade(infracaoId) {
            currentInfractionId = infracaoId;
            const infraction = appData.infracoes.find(i => i.id === infracaoId);
            
            if (!infraction) return;
            
            // Preencher resumo da infra√ß√£o
            const summary = document.getElementById('infraction-summary');
            if (summary) {
                summary.innerHTML = `
                    <div class="summary-title">Infra√ß√£o de ${infraction.aluno}</div>
                    <div class="summary-details">
                        <strong>Professor:</strong> ${infraction.professor}<br>
                        <strong>Turma:</strong> ${infraction.turma}<br>
                        <strong>Data:</strong> ${new Date(infraction.data + 'T00:00:00').toLocaleDateString('pt-BR')} √†s ${infraction.hora}<br>
                        <strong>Descri√ß√£o:</strong> ${infraction.descricao}<br>
                        ${infraction.observacoes ? `<strong>Observa√ß√µes:</strong> ${infraction.observacoes}` : ''}
                    </div>
                `;
            }
            
            // Limpar select de penalidade
            const penalidadeSelect = document.getElementById('penalidade-select');
            if (penalidadeSelect) penalidadeSelect.value = '';
            
            // Mostrar modal
            const modal = document.getElementById('penalidade-modal');
            if (modal) modal.classList.remove('hidden');
        }

        function fecharModal() {
            const modal = document.getElementById('penalidade-modal');
            if (modal) modal.classList.add('hidden');
            currentInfractionId = null;
        }

        function handlePenalidadeSubmit(e) {
            e.preventDefault();
            
            const penalidadeSelect = document.getElementById('penalidade-select');
            const penalidade = penalidadeSelect ? penalidadeSelect.value : '';
            
            if (!penalidade) {
                showMessage('Por favor, selecione uma penalidade', 'error');
                return;
            }
            
            // Atualizar infra√ß√£o
            const infraction = appData.infracoes.find(i => i.id === currentInfractionId);
            if (infraction) {
                infraction.status = 'resolvida';
                infraction.penalidade = penalidade;
                infraction.dataResolucao = new Date().toISOString().split('T')[0];
            }
            
            // Atualizar interface
            calculateStatistics();
            loadInfractionsList();
            
            // Fechar modal
            fecharModal();
            
            showMessage('Penalidade aplicada com sucesso!', 'success');
        }

        // Sistema de mensagens
        function showMessage(text, type = 'success') {
            const container = document.getElementById('message-container');
            if (!container) return;
            
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            container.appendChild(message);
            
            // Remover mensagem ap√≥s 3 segundos
            setTimeout(() => {
                if (message.parentNode) {
                    message.parentNode.removeChild(message);
                }
            }, 3000);
        }

        // Inicializa√ß√£o da data e hora a cada minuto
        setInterval(updateCurrentDateTime, 60000);
    </script>
</body>
</html>